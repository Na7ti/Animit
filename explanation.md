# Django基礎

## models.py
### 標準のUserモデルが持つフィールド

| field      |                            補足                                      |
|----------- |----------------------------------------------------------------------|
| username   |	必須。 150文字以下。ユーザー名には英数字が含まれている場合があります|
| first_name | オプション(blank=True)。150 文字以下。                               |
| last_name  | オプション(blank=True)。150 文字以下。                               |
| email      | オプション(blank=True)。メール                                       | 
| password   |	必須。パスワードのハッシュとメタデータ。                            |

* is_active属性はそのユーザーが有効化されているかを示す。is_activeがFalseに設定されているユーザーは、認証プロセスを通過してもログインすることはできない
* blankはDjangoのフォームからの投稿が空かどうかを判定するもの、nullはデータベースの中身が空かどうかを判定するもの
  
### 標準のUserモデルが非推奨とされる理由
* 拡張性が低い
* 将来変更するときにコストがかかる
* Userモデルで一度定義していまうと(migrationすると)もうカスタムユーザーにはできないから

## カスタムユーザー
* **AbstractUser**を継承することで作成できる
* UserモデルはAbstractUserを継承したもの
* カスタムユーザーモデルでは、AbstractUserのフィールドに存在しないフィールドを指定。
* USERNAME_FIELD: ユーザーを認証する際に使用されるユーザーモデルのフィールド。デフォルトではusernameが使用される。ユーザーを一意に識別
* REQUIRED_FIELDS: createsuperuser コマンドを使用してスーパーユーザーを作成する際にプロンプトで求められるフィールドのリスト


## 認証に使用するユーザーモデルをカスタムユーザに変更(setting.py)
AUTH_USER_MODEL = 'アプリ名.カスタムユーザーのModel名'

#今回だと
AUTH_USER_MODEL = 'アプリ名.CustomUser'

## makemigrationとmigrate


### migrate(モデルをデータベースに反映させる)
### makemigrations(マイグレーションファイルを作成する)

マイグレーション (Migrations) は、Django でモデルに対して行った変更 (フィールドの追加やモデルの削除など) をデータベーススキーマに反映させる方法  
マイグレーションというのは、データベーススキーマに対するバージョン管理システムのようなもの。makemigrations はモデルの変更点を1つのマイグレーションファイルにパッケージングし(コミットのようなもの)、migrate はその変更点をデータベースに適用する

## views.py
### クラスベースビュー
- *args は任意の数の位置引数をタプルとして受け取ります。
- **kwargs は任意の数のキーワード引数を辞書として受け取ります。

### render関数
受け取れる引数はrequest オブジェクト、テンプレートの名前、そしてコンテキスト（テンプレートに渡す変数を含む辞書）の3つのみ。


## cstr_tokenの仕組み


## forms.py
### cleanメソッド
フィールドのバリデーションチェック方法を指定。特定のフィールドを検証する場合であればclean_xxx()、フォーム全体に対する追加の検証を行うのであればclean()メソッドを用いる  
is_validメソッドが実行された時に自動で実行される。以下の3つを行う必要がある  

1. 検証するフィールドの値はcleaned_dataを用いて取得する
2. 検証に引っかかった場合にはforms.ValidationErrorを投げる
3. 最後にフィールド値を返す。

## データベース
**DjangoはORM(Object-Relational Mapping)を採用**  
データベースとマッピングされたオブジェクトを利用して、データベースを操作する技法  
SQLを意識せずにデータベース上のデータを管理することができる


## エラー
* リバースアクセサの衝突  
-> [related_nameとは](https://djangobrothers.com/blogs/related_name/)
* HTMLの要素がそのままブラウザに表示される  
-> render引数の数が4つ以上渡されている